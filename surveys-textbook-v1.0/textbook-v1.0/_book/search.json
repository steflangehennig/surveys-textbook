[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Survey Methodologies for Social Scientists",
    "section": "",
    "text": "This is the github repository for the work-in-progress first edition of Survey Methodologies for Social Scientists.\nThe goal of this book is to teach you how to do create, conduct, and analyze surveys with R.\n\n\nMore to come!"
  },
  {
    "objectID": "ch01intro.html",
    "href": "ch01intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "This book is geared toward undergraduates learning survey methodologies. This includes, but is not limited to, the psychology of the survey response process; creating and disseminating survey questions; survey modes; sampling and weighting; ethics; and survey analysis and reporting."
  },
  {
    "objectID": "ch01intro.html#learning-objectives",
    "href": "ch01intro.html#learning-objectives",
    "title": "1  Introduction",
    "section": "1.1 Learning Objectives",
    "text": "1.1 Learning Objectives"
  },
  {
    "objectID": "ch02psych_response.html",
    "href": "ch02psych_response.html",
    "title": "2  Psychology of Survey Response Response",
    "section": "",
    "text": "Outlines the psychology processes that occur when a participant responds to a survey."
  },
  {
    "objectID": "ch02psych_response.html#learning-objectives",
    "href": "ch02psych_response.html#learning-objectives",
    "title": "2  Psychology of Survey Response Response",
    "section": "2.1 Learning Objectives",
    "text": "2.1 Learning Objectives"
  },
  {
    "objectID": "ch07weights.html",
    "href": "ch07weights.html",
    "title": "7  Survey Weighting",
    "section": "",
    "text": "Note: This tutorial uses the anesrake package to calculate the survey weights. They are many other packages to calculate weights so this is just one possible approach that could successfully be used to create survey weights.\nSurvey weights are widely used in survey research for a variety of purposes. In this tutorial, we will be focusing on one specific form of survey weights called a “rake weight”. Rake weights are typically used to make the survey sample match the target population on a set of demographic, and sometimes attitudinal, measures. They are used to ensure the sample’s demographics match the target population’s demographics. This numerical correction will change how much each individual case in your dataset is contributing to the overall, or sub-group, mean values across your sample data.\nFirst, we load necessary packages to compute and analyze the weights. If a package is not installed on your machine, you must first install it before this chunk of code will run."
  },
  {
    "objectID": "ch07weights.html#import-your-survey-data-into-r",
    "href": "ch07weights.html#import-your-survey-data-into-r",
    "title": "7  Survey Weighting",
    "section": "7.2 Import your survey data into R",
    "text": "7.2 Import your survey data into R\nWe need to import our survey data into R. The way we do this will vary by the format of your data, but in this case the data is saved as a “.dta” file so we will use the haven package to import it.\nYou should always examine your data and the base R function head shows the first 5 cases along with all of your column labels.\n\n\n [1] \"caseid\"         \"pid_4\"          \"ideo5\"          \"gov_choice\"    \n [5] \"prop_111\"       \"prop_112\"       \"trump_app\"      \"hick_app\"      \n [9] \"gardner_app\"    \"cong_app\"       \"scotus_app\"     \"pot_law\"       \n[13] \"gambling\"       \"fracking\"       \"gun_control\"    \"anger\"         \n[17] \"pride\"          \"hope\"           \"disgust\"        \"worry\"         \n[21] \"trump_app2\"     \"hick_app2\"      \"gardner_app2\"   \"cong_app2\"     \n[25] \"scotus_app2\"    \"pot_law2\"       \"gambling2\"      \"fracking2\"     \n[29] \"gun_control2\"   \"old_weight_old\" \"pid_x\"          \"sex\"           \n[33] \"race_4\"         \"speakspanish\"   \"marstat\"        \"child18\"       \n[37] \"employ\"         \"faminc_new\"     \"casscd\"         \"religiosity\"   \n[41] \"age_group\"      \"educ\""
  },
  {
    "objectID": "ch07weights.html#save-your-target-population-demographic-parameters",
    "href": "ch07weights.html#save-your-target-population-demographic-parameters",
    "title": "7  Survey Weighting",
    "section": "7.3 Save Your Target Population Demographic Parameters",
    "text": "7.3 Save Your Target Population Demographic Parameters\nYou will need to know the target population proportion for each of the variables you wish to weight your sample data on. How easy it will be to find your population values will be based on your specific target population.\nSome populations will be relatively easy to find (e.g. think adult demographic proportions in the United States from the Census, CPS, or ACS results and all the sub-geographic levels that accompany them), but others won’t be as easy. Sometimes, you cannot know your target population proportions so in those cases you will not be able to weight your survey sample data.\nIn this chunk of R code, we are creating the target population parameters for two specific demographic variables measured in our sample political poll data. This was a political poll conducted in October 2018 with the sample consisting of likely Colorado voters in the then upcoming 2018 election. This gubernatorial election year poll measured multiple things including: - 2018 Colorado Gubernatorial Preference - Jared Polis or Walker Stapleton - Policy Questions: Marijuana Legalization, Fracking, Gun Control laws - Approval ratings: President Donald Trump, Governor John Hickenlooper (at the time), US Congress - Demographic questions for survey weighting purposes\n\n7.3.1 Saving New Vectors With Target Population Demographic Values\nUsing this data, let’s create some survey weights. To illustrate the principle, we will start with basic weights using just two demographic variables commonly used in calculating survey weights: sex (unfortunately only biological sex was collected in this survey) and age (split into 5 categories). We must save a vector of data with the target population demographic proportions, so in this case we will save two vectors one called sex and one called age_group.\nThere are two critical things to get correct in this step.\n1. Matching Names The names we give these vectors matter and must match the names of the appropriate demographic variable in your sample data. Since the vector names we chose were sex and age_group, the variable names in the sample data must be exactly sex and age_group. Otherwise, the code will not be able to match the two and will fail.\n2. Matching Orders The second critical thing to get correct is the order the proportion values are entered into the vector must match the order the proportion values are stored in the sample data. In this example, the order of proportions stored in the sex variable in the sample data is (female, male) so the values we give the sex vector must be in that exact order as well. The same is true for the age_group variable, which has 5 groups in the sample data: 18-29, 30-39, 40-49, 50-64, 65+. The proportion order in our vector for the age_group must match that exactly as well otherwise you are creating incorrect weights or best-case scenario getting an error message.\n\nsex &lt;- c(.525, .475)  #Target values for females and males; label order (female, male)\nsum(sex) #proportions should = 1 so this checks that it does\n\n[1] 1\n\nage_group  &lt;- c(.182, .203, .17, .218, .227)  #Target values for 5 age groups; 18-29, 30-39, 40-49, 50-64, 65+\nsum(age_group) #proportions should = 1 so this checks that it does\n\n[1] 1\n\n\nFirst, let’s look at the unweighted values in both the age and sex variables.\n\n#Shows the unweighted size of the age_group demographics\nsample %&gt;%\n  group_by(age_group) %&gt;%\n  summarise(n = n()) %&gt;% \n  mutate(proportion = n /sum(n))\n\n# A tibble: 5 × 3\n  age_group     n proportion\n  &lt;dbl+lbl&gt; &lt;int&gt;      &lt;dbl&gt;\n1 1 [18-29]    33     0.0412\n2 2 [30-39]   101     0.126 \n3 3 [40-49]   118     0.148 \n4 4 [50-64]   306     0.382 \n5 5 [65+]     242     0.302 \n\n#Shows the unweighted size of the sex demographics\nsample %&gt;%\n  group_by(sex) %&gt;%\n  summarise(n = n()) %&gt;% \n  mutate(proportion = n /sum(n))\n\n# A tibble: 2 × 3\n  sex            n proportion\n  &lt;dbl+lbl&gt;  &lt;int&gt;      &lt;dbl&gt;\n1 1 [Female]   423      0.529\n2 2 [Male]     377      0.471"
  },
  {
    "objectID": "ch07weights.html#calculating-your-rake-weights",
    "href": "ch07weights.html#calculating-your-rake-weights",
    "title": "7  Survey Weighting",
    "section": "7.4 Calculating Your Rake Weights",
    "text": "7.4 Calculating Your Rake Weights\nNow that we have our target population parameters saved in vectors for each demographic variable we plan to weight our survey data on and our sample data with matching names and orders, we can begin to create our survey weights.\n1. Create List First, we create a list that merges the two demographic vectors for use in the raking process. Remember, this names must match the column names in the sample data. We give this list the name of targets to reflect this is the target population parameters we want to match the sample data to. We then give the column names to match with the sample data.\n2. Calculate the Weights Now, it is time to create some survey weights using the anesrake function. This function has many possible items that could be used, with all the possible items listed in the following R chunk. You should view the R documentation for all possible things it can do.\nFor our purposes, we will be focusing on a few things that will be noted. We will calculate a new dataframe called myweights where we input the targets list, the name of our sample data cpc, a caseid value that uniquely identifies each case, the cap item tells the function to cape the size of the survey weights at 8 and not allow any case to have a weight larger than that value. The type item tells the function how it should handle, if at all, a target population demographic that is very close to the sample value for that same demographic.\nYou’ll see in the output once you run the anesrake function how many iterations it took for the raking to converge on this specific set of weights. Here, it took 15 iterations across the two target demographic variables.\n3. Save Weights in Sample Data Next, we save that newly created weight as a new variable in our existing sample data, and now we have a weight variable that we can use in our analysis of the data.\n\n#Now we save these values as a list and call the list targets\n#Step 1: Save the target list \ntargets &lt;- list(sex, age_group)\n# remember, these names will have to match\nnames(targets) &lt;- c(\"sex\", \"age_group\")\n\n#anesrake(targets, dataframe, caseid, weightvec = NULL, cap = 5,\n#verbose = FALSE, maxit = 1000, type = \"pctlim\", pctlim = 5,\n#nlim = 5, filter = 1, choosemethod = \"total\", iterate = TRUE)\n\n#Step 2 - Calculate the Rake Weight\nset.seed(1599385) #Set the seed for replication  \nmyweights &lt;- anesrake(targets, sample, \n                      caseid = sample$caseid, cap = 8, type = \"nolim\", pctlim=.05)\n\n[1] \"Raking converged in 12 iterations\"\n\n#Step 3 - Save the Rake Weight at the end of your sample data\nsample$weight  &lt;- unlist(myweights[1])"
  },
  {
    "objectID": "ch07weights.html#reviewing-the-newly-created-survey-weights",
    "href": "ch07weights.html#reviewing-the-newly-created-survey-weights",
    "title": "7  Survey Weighting",
    "section": "7.5 Reviewing the Newly Created Survey Weights",
    "text": "7.5 Reviewing the Newly Created Survey Weights\nBefore we start the analysis of the weighted data, let’s examine the newly created survey weights saved in our sample data.\nWith only 2 target weighting variables with 10 total categories combined between them, we can examine the weights individually by group. To do this, we will use the srvyr package to examine the weight size by the target groups.\n\n#Displays summary of the weight size to see range\nsummary(sample$weight)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.5347  0.6086  0.6997  1.0000  1.0912  4.8008 \n\n#Shows the weight size by demographic groups used in the weighting scheme\nsample %&gt;% \n  as_survey(weights = c(weight)) %&gt;%\n  group_by(sex, age_group) %&gt;% \n  summarise(weight = survey_mean(weight, na.rm = T))\n\n# A tibble: 10 × 4\n# Groups:   sex [2]\n   sex        age_group weight weight_se\n   &lt;dbl+lbl&gt;  &lt;dbl+lbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;\n 1 1 [Female] 1 [18-29]  4.22   0       \n 2 1 [Female] 2 [30-39]  1.51   2.86e-17\n 3 1 [Female] 3 [40-49]  1.09   0       \n 4 1 [Female] 4 [50-64]  0.535  0       \n 5 1 [Female] 5 [65+]    0.700  0       \n 6 2 [Male]   1 [18-29]  4.80   0       \n 7 2 [Male]   2 [30-39]  1.72   3.22e-17\n 8 2 [Male]   3 [40-49]  1.24   0       \n 9 2 [Male]   4 [50-64]  0.609  0       \n10 2 [Male]   5 [65+]    0.796  0       \n\n\nNow we see the weight size for each of the 10 groups that we weighted our sample data on. Obviously, with more demographic variables including in the weighting scheme this list would get much more cumbersome but for pedagogical purposes it is important to look at these values to understand their meaning.\nFor females between the age of 18-29 the weight equals 4.21. This means that females between the ages of 18-29 are under-represented in the sample data since the value is over 1. Fundamentally what this means is that for each female between the ages of 18-29 in the sample data, they are “speaking” for 4.21 females between the age of 18-29 from the target population. Compare this value to females between the ages of 50 and 64 (group 4) who have a weight value of .53. This means that females in this age group were over-represented in the sample data since the weight value is under 1.\nWe should also look at the weighted demographic values to ensure the weights worked as we hope they do - i.e. the weighted sample demographic values match the target population values.\n\n#Shows the unweighted size of the age_group demographics\nsample %&gt;%\n  group_by(age_group) %&gt;%\n  summarise(n = n()) %&gt;% \n  mutate(proportion = n /sum(n))\n\n# A tibble: 5 × 3\n  age_group     n proportion\n  &lt;dbl+lbl&gt; &lt;int&gt;      &lt;dbl&gt;\n1 1 [18-29]    33     0.0412\n2 2 [30-39]   101     0.126 \n3 3 [40-49]   118     0.148 \n4 4 [50-64]   306     0.382 \n5 5 [65+]     242     0.302 \n\n#Shows the weighted size of the age_group demographics\nsample %&gt;%\n  as_survey(weights = c(weight)) %&gt;%\n  group_by(age_group) %&gt;%\n  summarise(n = survey_total()) %&gt;% \n  mutate(proportion = n /sum(n))\n\n# A tibble: 5 × 4\n  age_group     n  n_se proportion\n  &lt;dbl+lbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;\n1 1 [18-29]  146. 24.9       0.182\n2 2 [30-39]  162. 15.2       0.203\n3 3 [40-49]  136  11.6       0.17 \n4 4 [50-64]  174.  7.87      0.218\n5 5 [65+]    182.  9.78      0.227\n\n#Saves the weighted & unweighted size of the age_group demographics\nag_w&lt;-sample %&gt;%\n  as_survey(weights = c(weight)) %&gt;%\n  group_by(age_group) %&gt;%\n  summarise(n = survey_total()) %&gt;% \n  mutate(weighted_sample = n /sum(n))\n\nag_uw&lt;- sample %&gt;%\n  group_by(age_group) %&gt;%\n  summarise(n = n()) %&gt;% \n  mutate(unweighted_sample = n /sum(n))\nag_combo&lt;-left_join(ag_w, ag_uw, by = \"age_group\", suffix = c(\"\", \"_pop\")) %&gt;%\n  group_by(age_group)\n\nag_combo$ag_diff_per&lt;- 100*(ag_combo$weighted_sample-ag_combo$unweighted_sample)\nag_combo\n\n# A tibble: 5 × 7\n# Groups:   age_group [5]\n  age_group     n  n_se weighted_sample n_pop unweighted_sample ag_diff_per\n  &lt;dbl+lbl&gt; &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;             &lt;dbl&gt;       &lt;dbl&gt;\n1 1 [18-29]  146. 24.9            0.182    33            0.0412       14.1 \n2 2 [30-39]  162. 15.2            0.203   101            0.126         7.68\n3 3 [40-49]  136  11.6            0.17    118            0.148         2.25\n4 4 [50-64]  174.  7.87           0.218   306            0.382       -16.4 \n5 5 [65+]    182.  9.78           0.227   242            0.302        -7.55\n\nprint(ag_combo$weighted_sample)\n\n[1] 0.182 0.203 0.170 0.218 0.227\n\nprint(targets)\n\n$sex\n[1] 0.525 0.475\n\n$age_group\n[1] 0.182 0.203 0.170 0.218 0.227\n\n\nWe see that the weighted age_group values match the target population values we inputted earlier so this weighting scheme seems to be working in the way that we hoped it would.\n\n#Shows the unweighted size of the sex demographics\nsample %&gt;%\n  group_by(sex) %&gt;%\n  summarise(n = n()) %&gt;% \n  mutate(proportion = n /sum(n))\n\n# A tibble: 2 × 3\n  sex            n proportion\n  &lt;dbl+lbl&gt;  &lt;int&gt;      &lt;dbl&gt;\n1 1 [Female]   423      0.529\n2 2 [Male]     377      0.471\n\n#Shows the weighted size of the sex demographics\nsample %&gt;%\n  as_survey(weights = c(weight)) %&gt;%\n  group_by(sex) %&gt;%\n  summarise(n = survey_total()) %&gt;% \n  mutate(proportion = n /sum(n))\n\n# A tibble: 2 × 4\n  sex            n  n_se proportion\n  &lt;dbl+lbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;\n1 1 [Female]   420  22.0      0.525\n2 2 [Male]     380  20.4      0.475\n\n\nFor the sex measure, the unweighted and weighted values matched nearly identically, but that is because the unweighted sample nearly matched the target population identically without any statistical correction. In these instances, it is common to drop the demographic variable that does not need much adjustment. The standard limit is 5% or less should not get an adjustment meaning that you should only apply weights with the target population values and the sample values are 5% points or more different."
  },
  {
    "objectID": "ch07weights.html#evaluating-influence-of-weights-on-reported-mean-values-in-the-sample-data---smallish-weights",
    "href": "ch07weights.html#evaluating-influence-of-weights-on-reported-mean-values-in-the-sample-data---smallish-weights",
    "title": "7  Survey Weighting",
    "section": "7.6 Evaluating Influence of Weights on Reported Mean Values in the Sample Data - Smallish Weights",
    "text": "7.6 Evaluating Influence of Weights on Reported Mean Values in the Sample Data - Smallish Weights\nNow let’s see what impact these weights have on our sample values. First, we use the surveys package must create a new dataframe that incorporates the survey weights. Let’s call it sample.weighted to signal that this is the weighted version of the sample data.\nWe need to calculate the weighted and unweighted means of the same variable. Using the fracking2 variable which measures support for fracking in the Colorado which various safety measures, we can compare the influence of the survey weights on the conclusions we would draw about support for fracking in Colorado.\nOnce we run the following R chunk, we see that there is virtually no difference between the weighted and unweighted estimates of how supportive Coloradoans are of fracking. Why is this? This occurs sometimes when the weights that applied simply do not change the sample composition enough to have an influence on the overall sample mean.\n\nfracking_uw&lt;-sample %&gt;% #Looks at the unweighted support for fracking in CO\n  summarise(unweight_support = mean(fracking2, na.rm = T))\n\nfracking_w&lt;-sample %&gt;% #Looks at the weighted support for fracking in CO\n  as_survey(weights = c(weight)) %&gt;%\n   summarise(weight_support = survey_mean(fracking2, na.rm = T))\n\n\nfracking_combo&lt;-cbind(fracking_uw, fracking_w ) \n\nfracking_combo &lt;- mutate(fracking_combo, difference = weight_support - unweight_support)\nfracking_combo\n\n  unweight_support weight_support weight_support_se  difference\n1        0.5277778      0.5025514         0.0229558 -0.02522642\n\n#Gubernatorial Vote Choice - Weighted & Unweighted \ngov_w&lt;-sample %&gt;%\n  as_survey(weights = c(weight)) %&gt;%\n  filter(!is.na(gov_choice)) %&gt;% \n  group_by(gov_choice) %&gt;%\n  summarise(n = survey_total()) %&gt;% \n  mutate(weight_support = n /sum(n)) \n\ngov_uw&lt;-sample %&gt;%\n  group_by(gov_choice) %&gt;%\n  filter(!is.na(gov_choice)) %&gt;% \n  summarise(n = n()) %&gt;% \n  mutate(unweight_support = n /sum(n))\n\ngov_combo&lt;-cbind(gov_uw, gov_w) \n\n\ngov_combo$diff &lt;- gov_combo$weight_support - gov_combo$unweight_support\ngov_combo\n\n  gov_choice   n unweight_support gov_choice         n      n_se weight_support\n1          1 413          0.51625          1 438.30863 22.858613     0.54788579\n2          2 346          0.43250          2 312.66152 17.843921     0.39082691\n3          3  30          0.03750          3  31.10659  6.029889     0.03888324\n4          4  11          0.01375          4  17.92325  7.817047     0.02240406\n          diff\n1  0.031635792\n2 -0.041673095\n3  0.001383243\n4  0.008654059"
  },
  {
    "objectID": "ch07weights.html#create-new-weighting-scheme-that-incorporates-more-demographic-variables",
    "href": "ch07weights.html#create-new-weighting-scheme-that-incorporates-more-demographic-variables",
    "title": "7  Survey Weighting",
    "section": "7.7 Create New Weighting Scheme That Incorporates More Demographic Variables",
    "text": "7.7 Create New Weighting Scheme That Incorporates More Demographic Variables\nTypically, when creating survey weights you will include more than just 2 demographic variables into your weighting scheme. Here, we use 5 variables to create a new weight: sex, age, race/ethnicity, education, and partisanship.\n\n#Save new vectors with target population values for weights \nsex &lt;- c(.525, .475)  ##Target values for females and males; label order (female, male)\nage_group  &lt;- c(.132, .183, .15, .248, .287)   #Target values for 5 age groups \nrace_4 &lt;-c(.7143, .0501, .1768, .0588) #Target values race/ethnic identities - white, black, Hispanic, all others\neduc &lt;-c(.2075, .2445, .0828, .2398, .2254) #Target values education - HS or less, Some college, AA, BA, Graduate degree\npid_4 &lt;-c(.3375, .2838, .335, .0437) #Target values Party Registration - (Democrats, Independents, Republicans, All 3rd Parties)  \n\n#Combine the demographic vectors into a list\ntargets &lt;- list(sex, age_group, race_4, educ, pid_4)\n# remember, these names will have to match the column names & order in the sample data \nnames(targets) &lt;- c(\"sex\", \"age_group\", \"race_4\", \"educ\", \"pid_4\")\n\nset.seed(1984)\nmyweights &lt;- anesrake(targets, sample, \n                      caseid = sample$caseid, cap = 8, type = \"pctlim\", pctlim=.05)    \n\n[1] \"Raking converged in 20 iterations\"\n[1] \"Raking converged in 21 iterations\"\n\nsample$full_weight  &lt;- unlist(myweights[1])\n\nsummary(sample$full_weight)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.3218  0.5685  0.7672  1.0000  1.0729  7.9999 \n\n\nLet’s look at how well the weights worked to match the sample data to the target population values for the race4 and educ5 measures.\n\n#Shows the weighted size of the educ5 demographics\n##We can also bind the two values together to calculate their differences \ned_w&lt;-sample %&gt;%\n  as_survey(weights = c(full_weight)) %&gt;%\n  group_by(educ) %&gt;%\n  summarise(n = survey_total()) %&gt;% \n  mutate(weighted_sample = n /sum(n))\n\ned_uw&lt;- sample %&gt;%\n  group_by(educ) %&gt;%\n  summarise(n = n()) %&gt;% \n  mutate(unweighted_sample = n /sum(n))\ned_combo&lt;-left_join(ed_w, ed_uw, by = \"educ\") %&gt;%\n  group_by(educ)\n\ned_combo$ed_diff_per&lt;- 100*(ed_combo$weighted_sample-ed_combo$unweighted_sample)\ned_combo\n\n# A tibble: 5 × 7\n# Groups:   educ [5]\n  educ             n.x  n_se weighted_sample   n.y unweighted_sample ed_diff_per\n  &lt;dbl+lbl&gt;      &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;             &lt;dbl&gt;       &lt;dbl&gt;\n1 1 [HS grad or… 166.  22.1           0.208     92             0.115       9.25 \n2 2 [Some colle… 196.  17.2           0.244    187             0.234       1.07 \n3 3 [AA degree]   66.2  7.29          0.0828    96             0.12       -3.72 \n4 4 [BA]         192.  14.3           0.240    249             0.311      -7.15 \n5 5 [Post-grad]  180.  14.3           0.225    176             0.22        0.540\n\n#Shows the weighted size of the race4 demographics\n##We can also bind the two values together to calculate their differences \nr_w&lt;-sample %&gt;%\n  as_survey(weights = c(full_weight)) %&gt;%\n  group_by(race_4) %&gt;%\n  summarise(n = survey_total()) %&gt;% \n  mutate(weighted_sample = n /sum(n))\n\nr_uw&lt;- sample %&gt;%\n  group_by(race_4) %&gt;%\n  summarise(n = n()) %&gt;% \n  mutate(unweighted_sample = n /sum(n))\nr_combo&lt;-left_join(r_w, r_uw, by = \"race_4\") %&gt;%\n  group_by(race_4)\n\nr_combo$r_diff_per&lt;- 100*(r_combo$weighted_sample-r_combo$unweighted_sample)\nr_combo\n\n# A tibble: 4 × 7\n# Groups:   race_4 [4]\n  race_4          n.x  n_se weighted_sample   n.y unweighted_sample r_diff_per\n  &lt;dbl+lbl&gt;     &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;             &lt;dbl&gt;      &lt;dbl&gt;\n1 1 [White]     571.  14.0           0.714    692            0.865     -15.1  \n2 2 [Black]      40.1  9.97          0.0501    22            0.0275      2.26 \n3 3 [Hispanic]  141.  25.1           0.177     41            0.0512     12.6  \n4 4 [Other POC]  47.0  7.56          0.0588    45            0.0562      0.255\n\n#Shows the weighted size of the pid_4 registered voter variable \n##We can also bind the two values together to calculate their differences \npid_w&lt;-sample %&gt;%\n  as_survey(weights = c(full_weight)) %&gt;%\n  group_by(pid_4) %&gt;%\n  summarise(n = survey_total()) %&gt;% \n  mutate(weighted_sample = n /sum(n))\n\npid_uw&lt;- sample %&gt;%\n  group_by(pid_4) %&gt;%\n  summarise(n = n()) %&gt;% \n  mutate(unweighted_sample = n /sum(n))\npid_combo&lt;-left_join(pid_w, pid_uw, by = \"pid_4\") %&gt;%\n  group_by(pid_4)\n\npid_combo$pid_diff_per&lt;- 100*(pid_combo$weighted_sample-pid_combo$unweighted_sample)\npid_combo\n\n# A tibble: 4 × 7\n# Groups:   pid_4 [4]\n  pid_4           n.x  n_se weighted_sample   n.y unweighted_sample pid_diff_per\n  &lt;dbl+lbl&gt;     &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt; &lt;int&gt;             &lt;dbl&gt;        &lt;dbl&gt;\n1 1 [Democrat]  270.  21.1           0.338    283            0.354        -1.62 \n2 2 [Independe… 227.  17.2           0.284    214            0.268         1.63 \n3 3 [Republica… 268.  19.8           0.335    266            0.332         0.250\n4 4 [Other]      35.0  6.55          0.0437    37            0.0462       -0.255\n\n\n\n#Gubernatorial Vote Choice - Weighted & Unweighted \ngov_w&lt;-sample %&gt;%\n  as_survey(weights = c(full_weight)) %&gt;%\n  filter(!is.na(gov_choice)) %&gt;% \n  group_by(gov_choice) %&gt;%\n  summarise(n = survey_total()) %&gt;% \n  mutate(weight_support = n /sum(n)) \n\ngov_uw&lt;-sample %&gt;%\n  group_by(gov_choice) %&gt;%\n  filter(!is.na(gov_choice)) %&gt;% \n  summarise(n = n()) %&gt;% \n  mutate(unweight_support = n /sum(n))\n\ngov_combo&lt;-cbind(gov_uw, gov_w) \n\n\ngov_combo$diff &lt;- gov_combo$weight_support - gov_combo$unweight_support\n\ngov_outcome&lt;-cbind(gov_combo$gov_choice, gov_combo$weight_support, gov_combo$unweight_support, gov_combo$diff) \n\ncolnames(gov_outcome) &lt;- c(\"candidate\", \"weighted support\", \"unewighted support\", \"diff\") \ngov_outcome\n\n     candidate weighted support unewighted support         diff\n[1,]         1       0.50298793            0.51625 -0.013262068\n[2,]         2       0.43459577            0.43250  0.002095774\n[3,]         3       0.04328807            0.03750  0.005788066\n[4,]         4       0.01912823            0.01375  0.005378227\n\n####Comparing weighted to unweighted fracking support in Colorado \n\nfracking_uw&lt;-sample %&gt;% #Looks at the unweighted support for fracking in CO\n  summarise(unweight_support = mean(fracking2, na.rm = T))\n\nfracking_w&lt;-sample %&gt;% #Looks at the weighted support for fracking in CO\n  as_survey(weights = c(full_weight)) %&gt;%\n   summarise(weight_support = survey_mean(fracking2, na.rm = T))\n\n\nfracking_combo&lt;-cbind(fracking_uw, fracking_w ) \n\nfracking_combo &lt;- mutate(fracking_combo, frack_diff = weight_support - unweight_support)\n\n#Do the same analysis for gun control then pot laws\ngc_uw&lt;-sample %&gt;% #Looks at the unweighted support for fracking in CO\n  summarise(unweight_support = mean(gun_control2, na.rm = T))\n\ngc_w&lt;-sample %&gt;% #Looks at the weighted support for fracking in CO\n  as_survey(weights = c(full_weight)) %&gt;%\n   summarise(weight_support = survey_mean(gun_control2, na.rm = T))\n\n\ngc_combo&lt;-cbind(gc_uw, gc_w ) \n\ngc_combo &lt;- mutate(gc_combo, gun_control_diff = weight_support - unweight_support)\n\npl_uw&lt;-sample %&gt;% #Looks at the unweighted support for fracking in CO\n  summarise(unweight_support = mean(pot_law2, na.rm = T))\n\npl_w&lt;-sample %&gt;% #Looks at the weighted support for fracking in CO\n  as_survey(weights = c(full_weight)) %&gt;%\n   summarise(weight_support = survey_mean(pot_law2, na.rm = T))\n\n\npl_combo&lt;-cbind(pl_uw, pl_w ) \n\npl_combo &lt;- mutate(pl_combo, pot_law_diff = weight_support - unweight_support)\n\n\ncombo&lt;-cbind(100*(fracking_combo$frack_diff),100*(gc_combo$gun_control_diff), 100*(pl_combo$pot_law_diff)) \n\ncolnames(combo) &lt;- c(\"fracking_diff\", \"gun_control_diff\", \"pot_law_diff\") \ncombo&lt;-round(combo,3)\ncombo\n\n     fracking_diff gun_control_diff pot_law_diff\n[1,]         2.651            0.531       -0.303\n\n\nAbove, shows the impact that the new weighting scheme had on the differences in support for fracking, new gun control policies, support for marijuana legalization and a tax revenue proposition on the upcoming ballot. For fracking, the weighted sample supported fracking 3.3 percentage points higher than the unweighted sample. While that might not seem like a large difference, in a polarized American electorate 3.3 percentage points easily be the differences between winning an election or going down in defeat.\nThe other three items all saw a decrease in support in the weighted data. Overall, the results showed increased support for a generally conservative supported issue, fracking, while revealing decreased support for 3 more liberal supported issues, gun control, marijuana legalization, and increased governmental spending. This is likely caused by weighting older voters to be\nWe can also use the newly created survey weights in regression analyses. To do so, you first must create a new weighted survey dataset that you then conduct the analysis on.\n\n#Using srvyr package to create a new weighted dataset for analysis purposes\n#Step 1: Create Weighted Survey Data for Analysis\nsample.weighted &lt;- sample %&gt;% \n  as_survey_design(ids = 1, # 1 for no cluster ids; use this for a simple random sample \n                   weights = full_weight, # No weight added\n                   strata = NULL # sampling was simple (no strata) \n                  )\n\nnonweighted &lt;-lm(gambling ~ pid_x + ideo5 + sex , data=sample)\nweighted &lt;-lm(gambling ~ pid_x + ideo5 + sex, data=sample, weights=sample$weight)\nweighted2 &lt;-lm(gambling ~ pid_x + ideo5 + sex, data=sample, weights=sample$full_weight)\n\nstargazer(nonweighted, weighted,  weighted2, type=\"text\")\n\n\n============================================================\n                                    Dependent variable:     \n                               -----------------------------\n                                         gambling           \n                                  (1)       (2)       (3)   \n------------------------------------------------------------\npid_x                           -0.017    -0.010    -0.013  \n                                (0.031)   (0.032)   (0.029) \n                                                            \nideo5                           -0.059    -0.065   -0.096** \n                                (0.051)   (0.051)   (0.047) \n                                                            \nsex                             0.184**  0.215***   0.188** \n                                (0.080)   (0.080)   (0.079) \n                                                            \nConstant                       2.391***  2.441***  2.591*** \n                                (0.153)   (0.154)   (0.157) \n                                                            \n------------------------------------------------------------\nObservations                      669       669       669   \nR2                               0.015     0.018     0.025  \nAdjusted R2                      0.011     0.013     0.021  \nResidual Std. Error (df = 665)   1.030     1.020     0.998  \nF Statistic (df = 3; 665)       3.481**  4.032***  5.678*** \n============================================================\nNote:                            *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01\n\n\nResults are largely similar across the regression models, but there are some slight differences between the unweighted model and the two weighted ones. This happens because certain respondent’s opinions are being given more or less weight to the overall average relationship which can cause the conclusions you draw from your analysis to differ. This is one reason why it is critically important to create your survey weights using defensible target population values."
  },
  {
    "objectID": "ch07weights.html#concluding-thoughts",
    "href": "ch07weights.html#concluding-thoughts",
    "title": "7  Survey Weighting",
    "section": "7.8 Concluding Thoughts",
    "text": "7.8 Concluding Thoughts\nThis is an important lesson for the application of the survey weights. The target population values that you weight your survey sample data to match can have profound implications on the conclusions you and others draw from your survey results. In the case, the decision to weight the survey to give more voice to the Republican members of the sample influenced the conclusions drawn about support for various policies being debated in the public realm. This makes it critically important to make sure that the target population values that are chosen are as accurate as possible and publicly defensible.\nOverall, this tutorial has taken you through how to calculate survey weights using the anesrake package. Using a sample political poll, you hopefully learned how to create target demographic population vectors, which then merge with our sample demographic values. Following this, you learned how to calculate directly survey weights, evaluate the success/failure of the survey weighting process, and compare the impact of using the survey weight on the conclusions drawn from the results.\n\nsessionInfo()\n\nR version 4.3.0 (2023-04-21 ucrt)\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\nRunning under: Windows 10 x64 (build 19044)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United Kingdom.utf8 \n[2] LC_CTYPE=English_United Kingdom.utf8   \n[3] LC_MONETARY=English_United Kingdom.utf8\n[4] LC_NUMERIC=C                           \n[5] LC_TIME=English_United Kingdom.utf8    \n\ntime zone: America/Denver\ntzcode source: internal\n\nattached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] stargazer_5.2.3   data.table_1.14.8 anesrake_0.80     weights_1.0.4    \n [5] Hmisc_5.1-0       survey_4.2-1      survival_3.5-5    Matrix_1.5-4     \n [9] srvyr_1.2.0       poliscidata_2.3.0 skimr_2.1.5       lubridate_1.9.2  \n[13] forcats_1.0.0     stringr_1.5.0     purrr_1.0.1       readr_2.1.4      \n[17] tibble_3.2.1      tidyverse_2.0.0   knitr_1.43        tidyr_1.3.0      \n[21] dplyr_1.1.2       ggplot2_3.4.2     haven_2.5.2      \n\nloaded via a namespace (and not attached):\n [1] tidyselect_1.2.0   bitops_1.0-7       fastmap_1.1.1      digest_0.6.32     \n [5] rpart_4.1.19       timechange_0.2.0   lifecycle_1.0.3    cluster_2.1.4     \n [9] gdata_2.19.0       magrittr_2.0.3     compiler_4.3.0     rlang_1.1.1       \n[13] tools_4.3.0        plotrix_3.8-2      utf8_1.2.3         htmlwidgets_1.6.2 \n[17] plyr_1.8.8         repr_1.1.6         abind_1.4-5        KernSmooth_2.23-20\n[21] withr_2.5.0        foreign_0.8-84     nnet_7.3-18        fansi_1.0.4       \n[25] jomo_2.7-6         caTools_1.18.2     xtable_1.8-4       colorspace_2.1-0  \n[29] mice_3.16.0        MASS_7.3-58.4      scales_1.2.1       gtools_3.9.4      \n[33] iterators_1.0.14   cli_3.6.1          crayon_1.5.2       rmarkdown_2.23    \n[37] generics_0.1.3     rstudioapi_0.14    tzdb_0.4.0         minqa_1.2.5       \n[41] DBI_1.1.3          splines_4.3.0      base64enc_0.1-3    mitools_2.4       \n[45] vctrs_0.6.3        boot_1.3-28.1      glmnet_4.1-7       jsonlite_1.8.5    \n[49] carData_3.0-5      car_3.1-2          hms_1.1.3          mitml_0.4-5       \n[53] Formula_1.2-5      htmlTable_2.4.1    foreach_1.5.2      glue_1.6.2        \n[57] pan_1.8            nloptr_2.0.3       codetools_0.2-19   stringi_1.7.12    \n[61] gtable_0.3.3       shape_1.4.6        lme4_1.1-33        munsell_0.5.0     \n[65] pillar_1.9.0       htmltools_0.5.5    gplots_3.1.3       R6_2.5.1          \n[69] evaluate_0.21      lattice_0.21-8     backports_1.4.1    broom_1.0.5       \n[73] descr_1.1.7        Rcpp_1.0.10        nlme_3.1-162       gridExtra_2.3     \n[77] checkmate_2.2.0    xfun_0.39          pkgconfig_2.0.3"
  },
  {
    "objectID": "ch09hyp_analysis_rep.html#hypothesis-testing",
    "href": "ch09hyp_analysis_rep.html#hypothesis-testing",
    "title": "9  Hypothesis Testing, Analysis, & Reporting",
    "section": "9.2 Hypothesis Testing",
    "text": "9.2 Hypothesis Testing"
  },
  {
    "objectID": "ch09hyp_analysis_rep.html#analysis",
    "href": "ch09hyp_analysis_rep.html#analysis",
    "title": "9  Hypothesis Testing, Analysis, & Reporting",
    "section": "9.3 Analysis",
    "text": "9.3 Analysis"
  },
  {
    "objectID": "ch09hyp_analysis_rep.html#reporting",
    "href": "ch09hyp_analysis_rep.html#reporting",
    "title": "9  Hypothesis Testing, Analysis, & Reporting",
    "section": "9.4 Reporting",
    "text": "9.4 Reporting"
  },
  {
    "objectID": "ch07weights.html#step-by-step-guide-to-creating-basic-rake-weights-in-r",
    "href": "ch07weights.html#step-by-step-guide-to-creating-basic-rake-weights-in-r",
    "title": "7  Survey Weighting",
    "section": "7.1 Step-By-Step Guide to Creating Basic Rake Weights in R",
    "text": "7.1 Step-By-Step Guide to Creating Basic Rake Weights in R\nNote: This tutorial uses the anesrake package to calculate the survey weights. They are many other packages to calculate weights so this is just one possible approach that could successfully be used to create survey weights.\nSurvey weights are widely used in survey research for a variety of purposes. In this tutorial, we will be focusing on one specific form of survey weights called a “rake weight”. Rake weights are typically used to make the survey sample match the target population on a set of demographic, and sometimes attitudinal, measures. They are used to ensure the sample’s demographics match the target population’s demographics. This numerical correction will change how much each individual case in your dataset is contributing to the overall, or sub-group, mean values across your sample data.\nFirst, we load necessary packages to compute and analyze the weights. If a package is not installed on your machine, you must first install it before this chunk of code will run."
  }
]